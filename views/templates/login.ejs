<% layout('layout/../boilerplate.ejs') %>

<div class="text-center" style="padding: 3rem 0;">
    <div class="modern-form">
        <!-- Header with animated icon -->
        <div class="text-center mb-4">
            <div style="position: relative; display: inline-block; margin-bottom: 1.5rem;">
                <div class="loading-pulse" style="background: var(--primary-color); width: 80px; height: 80px;"></div>
                <i class="fas fa-brain" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 2rem; color: white;"></i>
            </div>
            <h1 style="font-size: 2.25rem; font-weight: 700; margin: 0; color: var(--text-primary); margin-bottom: 0.5rem;">Welcome Back</h1>
            <p style="color: var(--text-secondary); margin: 0; font-size: 1.1rem;">Sign in to continue your emotion analytics journey</p>
        </div>

        <form action="/login" method="POST" class="validated-form" novalidate id="loginForm">
            <div class="form-group">
                <label class="form-label" for="username">Enrollment Number</label>
                <input class="form-input" type="text" name="username" id="username" autofocus required placeholder="Enter your enrollment number">
                <div class="invalid-feedback">Please enter your enrollment number</div>
            </div>

            <div class="form-group">
                <label class="form-label" for="password">Password</label>
                <input class="form-input" type="password" name="password" id="password" required placeholder="Enter your password">
                <div class="invalid-feedback">Please enter your password</div>
            </div>

            <div class="text-center mb-4">
                <a href="/forgot-password" style="color: var(--primary-color); text-decoration: none; font-weight: 500; display: inline-flex; align-items: center; gap: 0.5rem;">
                    <i class="fas fa-key"></i> Forgot Password?
                </a>
            </div>

            <button type="submit" class="btn-modern btn-primary w-full mb-4" id="loginBtn">
                <i class="fas fa-sign-in-alt"></i> 
                <span>Sign In</span>
            </button>

            <div class="text-center">
                <div style="position: relative; margin: 1.5rem 0;">
                    <div style="position: absolute; top: 50%; left: 0; right: 0; height: 1px; background: var(--border);"></div>
                    <span style="background: var(--background); padding: 0 1rem; color: var(--text-secondary); font-size: 0.9rem;">or</span>
                </div>
                
                <p style="color: var(--text-secondary); margin-bottom: 1rem; font-size: 0.95rem;">
                    Don't have an account? 
                </p>
                <a href="/register" class="btn-modern btn-outline w-full mb-3">
                    <i class="fas fa-user-plus"></i> Create New Account
                </a>
                
                <a href="/login/admin" style="color: var(--accent-color); text-decoration: none; font-weight: 500; display: inline-flex; align-items: center; gap: 0.5rem; justify-content: center;">
                    <i class="fas fa-user-shield"></i> Admin Access
                </a>
            </div>
        </form>
    </div>
</div>

<script>
document.getElementById('loginForm').addEventListener('submit', function(e) {
    const btn = document.getElementById('loginBtn');
    btn.classList.add('loading');
    btn.innerHTML = '<div class="loading"></div> <span>Signing In...</span>';
});

// Check for logout success message
document.addEventListener('DOMContentLoaded', function() {
    const urlParams = new URLSearchParams(window.location.search);
    if (urlParams.get('logout') === 'success') {
        // Show a temporary success message
        const successMsg = document.createElement('div');
        successMsg.className = 'alert alert-success';
        successMsg.style.cssText = 'position: fixed; top: 20px; right: 20px; z-index: 9999; padding: 1rem; background: #10b981; color: white; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.15);';
        successMsg.innerHTML = '<i class="fas fa-check-circle"></i> Successfully signed out';
        document.body.appendChild(successMsg);
        
        // Remove message after 3 seconds
        setTimeout(() => {
            successMsg.remove();
        }, 3000);
        
        // Clean up URL
        window.history.replaceState({}, document.title, window.location.pathname);
    }
});
</script>
