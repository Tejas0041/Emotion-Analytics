<% layout('layout/../boilerplate.ejs') %>

<style>
  .card-options {
    position: absolute;
    top: 10px;
    right: 10px;
    display: none;
    background-color: #afafaf;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    border-radius: 5px;
    z-index: 1000;
  }

  .ellipsis:hover .card-options {
    display: block;
  }

  .option-link {
    display: block;
    padding: 10px;
    text-decoration: none;
    color: #000;
    font-weight: bold;
    transition: background-color 0.3s;
  }

  .option-link:hover {
    background-color: #616161;
  }
</style>

<div style="min-height: 88.8vh;" class="mt-3">
  <div class="dropdown" style="position: absolute; top: 60; right: 0; margin-right: 20px;">
    <button class="btn btn-dark dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
      Filter
    </button>
    <ul class="dropdown-menu dropdown-menu-dark">
      <li><a class="dropdown-item" href="/homeadmin/all">View All</a></li>
      <li><hr class="dropdown-divider"></li>
      <li><a class="dropdown-item" href="/homeadmin/active">View only active</a></li>
      <li><hr class="dropdown-divider"></li>
      <li><a class="dropdown-item" href="/homeadmin/deactive">View only deactive</a></li>
    </ul>
  </div>

  <% if(users.length===0){ %>
      <div style="display: flex; justify-content: center;">
        <h2>No users are Deactivated currently</h2>
      </div>
  <% }else{ %>
  <% for(let u of users){ %>
    <% if((u.username!='Admin') && u.verified===true) {%>
      <center>
        <div class="card mb-3" style="max-width: 540px;  background: linear-gradient(to right, white, grey);">
          <% if(u.active){ %>
            <div class="row g-0">
          <% }else{ %>
          <div class="row g-0" style="opacity: 0.55;">
          <% } %>
            <div class="col-md-4">
              <img src="<%= u.image[0].thumbnail %>" class="img-fluid rounded-start" alt="">
            </div>
            <div class="col-md-8">
              <div class="card-body">
                <span class="card-title fs-5"><b><%= u.fullname %></b></span>

                <!-- Three dots with options -->
                <div class="ellipsis">
                  <span style="position: absolute; top: 0; right: 0; margin: 10px; background-color: #a4a3a3c9; height: 25px; width: 25px; border-radius: 50%;"><b>&vellip;</b></span>
                  <div class="card-options">
                    <% if(u.active){ %>
                      <a href="/deactivate/<%= u._id %>" class="option-link">Deactivate</a>
                    <% }else{ %>
                      <a href="/activate/<%= u._id %>" class="option-link">Activate</a>
                    <% } %>
                    <a href="#" class="option-link">Analytics</a>
                    <a href="/viewprofile/<%= u._id %>" class="option-link">View Profile</a>
                  </div>
                </div>

                <p class="card-text" style="text-align: left;"><b>Enrollment: </b><%= u.username %></p>
                <p class="card-text" style="text-align:left;"><b>Semester: </b><%= u.semester %></p>
                <p class="card-text" style="text-align: left;"><b>Gsuite Id: </b><%= u.gsuite %></p>
              </div>
            </div>
          </div>
        </div>
      </center>
    <% } %>
   <% } %>
  <% } %>
</div>
